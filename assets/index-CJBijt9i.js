import{r as i,j as e,f as q,g as Q}from"./vendor-DAj6e5wc.js";import{u as k,V as f,a as $,b as V,R as J,C as ee}from"./vendor-three-dBrnf_R4.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const l of t.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerPolicy&&(t.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?t.credentials="include":r.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function s(r){if(r.ep)return;r.ep=!0;const t=o(r);fetch(r.href,t)}})();const te=[{id:"project-1-chat-app",title:"实时聊天应用",description:"基于 React 和 Socket.io 的高性能实时聊天平台。",tags:["React","Socket.io","Node.js"],links:{github:"https://github.com/your/chat-app",liveDemo:"https://demo.chat-app.com"},position:[-3,.5,3],model:"chat-bubble.glb"},{id:"project-2-3d-viz",title:"WebGL 数据可视化",description:"使用 Three.js 实现的大规模数据可视化仪表板。",tags:["Three.js","D3.js","WebGL"],links:{github:"https://github.com/your/3d-viz"},position:[3,.5,3],model:"globe.glb"},{id:"project-3-e-commerce",title:"现代电商平台",description:"使用 Vue/Next.js 开发的微服务架构电商网站。",tags:["Vue.js","Next.js","PostgreSQL"],links:{github:"https://github.com/your/ecommerce"},position:[0,.5,-4],model:"shop-cart.glb"}],H="models/pokemon_center.glb";function oe({onLoaded:n,...c}){const{scene:o}=k(H),s=i.useRef(null);return i.useEffect(()=>{const r=[];o.traverse(t=>{t.isMesh&&t.name&&(t.name.toLowerCase().includes("floor")||r.push(t))}),n&&n(r)},[o,n]),e.jsx("primitive",{ref:s,object:o,scale:10,rotation:[0,0,0],position:[-.4,0,0],...c})}k.preload(H);function re(){const[n,c]=i.useState({KeyW:!1,KeyA:!1,KeyS:!1,KeyD:!1,ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1});return i.useEffect(()=>{const o=r=>{c(t=>Object.prototype.hasOwnProperty.call(t,r.code)?{...t,[r.code]:!0}:t)},s=r=>{c(t=>Object.prototype.hasOwnProperty.call(t,r.code)?{...t,[r.code]:!1}:t)};return window.addEventListener("keydown",o),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",o),window.removeEventListener("keyup",s)}},[]),n}const W="models/player_model.glb";function ne({collidableObjects:n=[],props:c}){const o=i.useRef(),s=i.useRef(new f),r=i.useRef(new f),t=0,l=6,h=7,y=.05,{scene:F,animations:G}=k(W),{actions:b}=$(G,o),A="House",w=.1,Y=.2,m=re(),g=i.useRef(null),P=i.useRef(!1),U=i.useRef(0),B=.5,M=i.useRef(new f(0,0,0));function E(d,p=.15){if(!b)return;const a=b[d];if(!a){console.warn("Animation not found:",d);return}const u=g.current;if(u!==a)try{a.reset(),a.play(),u?u.crossFadeTo(a,p,!1):a.fadeIn(p),g.current=a}catch(x){console.error("playAction error:",x)}}return i.useEffect(()=>{if(!b)return;const d=b[A];if(d)try{d.reset(),d.play(),g.current=d}catch(p){console.error("Error playing initial animation:",p)}},[b]),V(d=>{const p=o.current.position;if(r.current.set(p.x+t,p.y+l,p.z+h),s.current.copy(p),s.current.y+=.5,d.camera.position.lerp(r.current,y),d.camera.lookAt(s.current),!o.current)return;M.current.copy(o.current.position);let a=!1,u=o.current.rotation.y,x=o.current.position.x,O=o.current.position.y,v=o.current.position.z;m.KeyW||m.ArrowUp?(u=Math.PI,v-=w,a=!0):(m.KeyS||m.ArrowDown)&&(u=0,v+=w,a=!0),m.KeyA||m.ArrowLeft?(u=-Math.PI/2,x-=w,a=!0):(m.KeyD||m.ArrowRight)&&(u=Math.PI/2,x+=w,a=!0);const X=new f(x,O,v);let S=!1;const N=X.clone().sub(o.current.position),K=N.length();if(K>1e-6&&n.length>0){const R=N.clone().normalize(),L=new f(-R.z,0,R.x).normalize(),I=R.clone(),T=[new f(0,.4,0),L.clone().multiplyScalar(.25).add(new f(0,.4,0)),L.clone().multiplyScalar(-.25).add(new f(0,.4,0)),I.clone().multiplyScalar(.15).add(new f(0,.4,0)),L.clone().multiplyScalar(.15).add(I.clone().multiplyScalar(.15)).add(new f(0,.4,0))];for(let C=0;C<T.length&&!S;C++){const Z=o.current.position.clone().add(T[C]),z=new J(Z,R,0,K+B).intersectObjects(n,!1);if(z.length>0&&z.find(_=>_.distance>1e-4&&!_.object.userData?.noCollide)){S=!0;break}}}S?o.current.position.copy(M.current):o.current.position.set(x,O,v),U.current=u;const j=u-o.current.rotation.y;let D=j;j>Math.PI?D=j-2*Math.PI:j<-Math.PI&&(D=j+2*Math.PI),o.current.rotation.y+=D*Y,a&&!P.current?(E("Walking",.12),g.current&&(g.current.timeScale=1.5)):!a&&P.current&&(E(A,.18),g.current&&(g.current.timeScale=1)),P.current=a}),e.jsx("group",{ref:o,...c,children:e.jsx("primitive",{object:F,scale:.7})})}k.preload(W);const se=({data:n,onProjectSelect:c,...o})=>{const s=i.useRef(),[r,t]=q.useState(!1),{onRegister:l}=o;return i.useEffect(()=>{l&&s.current&&l(s.current)},[l]),V((h,y)=>{s.current&&(s.current.rotation.y+=.5*y)}),e.jsxs("mesh",{...o,ref:s,scale:r?1.8:1.5,onClick:()=>c(n),onPointerOver:h=>t(!0),onPointerOut:h=>t(!1),children:[e.jsx("boxGeometry",{args:[1,1,1]}),e.jsx("meshStandardMaterial",{color:r?"#ff0000":"#4e79a7"})]})},ie=({onProjectSelect:n})=>{const[c,o]=i.useState([]),s=i.useCallback(t=>{o(l=>l.includes(t)?l:[...l,t])},[o]),r=i.useCallback(t=>{o(l=>{const h=t.filter(y=>!l.includes(y));return[...l,...h]}),console.log(`[Collision] Loaded ${t.length} model meshes.`)},[o]);return e.jsxs(e.Fragment,{children:[e.jsx("ambientLight",{intensity:.5}),e.jsx("directionalLight",{position:[10,10,5],intensity:2,castShadow:!0}),"//注释从而禁止用户自由控制相机，相机逻辑在 Player 组件中处理",e.jsx(oe,{onLoaded:r}),e.jsx(ne,{collidableObjects:c,position:[0,0,1]}),te.map(t=>e.jsx(se,{data:t,position:t.position,onProjectSelect:n,onRegister:s},t.id))]})},ce="/my-portfolio/assets/react-CHdo91hT.svg",le="/my-portfolio/vite.svg",ae={position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"400px",maxWidth:"90vw",padding:"30px",backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:20,color:"#333",maxHeight:"80vh",overflowY:"auto"},de=({project:n,onClose:c})=>n?e.jsxs("div",{style:ae,children:[e.jsx("button",{onClick:c,style:{position:"absolute",top:"10px",right:"10px",background:"none",border:"none",fontSize:"1.2rem",color:"#333",cursor:"pointer"},children:"× "}),e.jsx("h2",{children:n.title}),e.jsx("p",{style:{color:"#666"},children:n.description}),e.jsx("hr",{style:{border:"0",borderTop:"1px solid #eee"}}),e.jsxs("p",{children:[e.jsx("strong",{children:"技术栈："})," ",n.tags.join(", ")]}),e.jsxs("div",{style:{display:"flex",gap:"15px",marginTop:"20px"},children:[n.links.liveDemo&&e.jsx("a",{href:n.links.liveDemo,target:"_blank",rel:"noopener noreferrer",children:e.jsx("button",{style:{backgroundColor:"#ff69b4",color:"white",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer"},children:"查看 Live Demo"})}),n.links.github&&e.jsx("a",{href:n.links.github,target:"_blank",rel:"noopener noreferrer",children:e.jsx("button",{style:{backgroundColor:"#4e79a7",color:"white",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer"},children:"GitHub 源码"})})]})]}):null;function ue(){const[n,c]=i.useState("3D"),[o,s]=i.useState(null),[r,t]=i.useState(0),l={position:"absolute",top:20,left:20,zIndex:10,padding:"10px 15px",backgroundColor:"white",border:"1px solid #ccc",cursor:"pointer",color:"black",fontWeight:"bold"};return e.jsxs("div",{style:{width:"100vw",height:"100vh",position:"relative"},children:[e.jsxs("button",{style:l,onClick:()=>c(n==="3D"?"2D":"3D"),children:["切换到 ",n==="3D"?"2D":"3D"," 视图"]}),n==="3D"?e.jsx(ee,{camera:{position:[0,7,12],fov:50},style:{background:"#000000ff"},children:e.jsx(ie,{onProjectSelect:s})}):e.jsxs("div",{className:"view-2d",children:[e.jsxs("div",{className:"content-centered",children:[e.jsx("h2",{children:"这是您的 2D 降级视图/作品列表"}),e.jsx("p",{children:"您可以在这里使用标准的 React 组件来展示作品。"}),e.jsxs("div",{children:[e.jsx("a",{href:"https://vite.dev",target:"_blank",children:e.jsx("img",{src:le,className:"logo",alt:"Vite logo"})}),e.jsx("a",{href:"https://react.dev",target:"_blank",children:e.jsx("img",{src:ce,className:"logo react",alt:"React logo"})})]}),e.jsx("h1",{children:"Vite + React"}),e.jsxs("div",{className:"card",children:[e.jsxs("button",{onClick:()=>t(h=>h+1),children:["count is ",r]}),e.jsxs("p",{children:["Edit ",e.jsx("code",{children:"src/App.jsx"})," and save to test HMR"]})]}),e.jsx("p",{className:"read-the-docs",children:"Click on the Vite and React logos to learn more"})]})," "]}),o&&e.jsx(de,{project:o,onClose:()=>s(null)})]})}Q.createRoot(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(ue,{})}));
